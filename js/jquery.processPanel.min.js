/*!
* Dynamic Step Process Panels
* http://codecanyon.net/item/dynamic-step-process-panels/118950?ref=quanticalabs
*
* Copyright 2010, QuanticaLabs
* You need to buy a license if you want use this script.
* http://codecanyon.net/item/dynamic-step-process-panels/118950?ref=quanticalabs
* http://codecanyon.net/wiki/buying/howto-buying/licensing/
*/
(function(a){function d(b){var c=a("#"+b.data.panelId).children("[href]").index(a(this));if(false===b.data.options.onHoverOut(b,a(this),c))return;if(a(this).get(0)===a("#"+b.data.panelId).children("[href]").first().get(0))a("#"+b.data.panelId+" .boxStart").css("background-position","-10px "+b.data.stepBg.split(" ")[1]);a(this).css({"background-position":parseInt(a(this).backgroundPosition().split(" ")[0])+"px "+b.data.stepBg.split(" ")[1],color:b.data.stepColor})}function c(b){var c=a("#"+b.data.panelId).children("[href]").index(a(this));if(false===b.data.options.onHoverIn(b,a(this),c))return;if(a(this).get(0)===a("#"+b.data.panelId).children("[href]").first().get(0))a("#"+b.data.panelId+" .boxStart").css("background-position","-10px "+b.data.hoverBg.split(" ")[1]);a(this).css({"background-position":parseInt(a(this).backgroundPosition().split(" ")[0])+"px "+b.data.hoverBg.split(" ")[1],color:b.data.hoverColor,cursor:"pointer"})}function b(e){var f=e.data.options;e.preventDefault();var g=null;if(a(this).attr("href")!=undefined&&a(this).attr("href").substr(0,1)!="#"&&a(this).attr("href")!="")g=a("#"+a(this).attr("href").split("#")[1]);else g=a(a(this).attr("href"));var h=a("#"+e.data.panelId).children("[href]").index(a(this));if(false===f.onOpen(e,a(this),g,h+1)){a(this).trigger("mouseout");return}a(this).unbind("mouseout",d);if(a(this).attr("href")!=undefined&&a(this).attr("href").substr(0,1)!="#"&&a(this).attr("href")!=""){var i=a(this).attr("href").split("#")[0];var j=a(this).attr("href").split("#")[1];a(e.data.contentsSelector+":not(#"+j+")").css("display","none");var k=a(this);a.ajax({url:i,type:"post",async:false,dataType:"html",success:function(b){a("#"+j).css({opacity:0,display:"block"}).html(b).animate({opacity:1},f.fadeSpeed,function(){if(jQuery.browser.msie)this.style.removeAttribute("filter")})}})}else{a(e.data.contentsSelector+":not("+a(this).attr("href")+")").css("display","none");a(a(this).attr("href")).css({opacity:0,display:"block"}).animate({opacity:1},f.fadeSpeed,function(){if(jQuery.browser.msie)this.style.removeAttribute("filter")})}if(!f.chooseAgain){a(this).unbind(f.event,b);a(this).bind(f.event,function(a){a.preventDefault()})}if(e.data.options.kind=="stepByStep"){if(a(this).next().attr("href")!=undefined&&a.data(a(this).next().get(0),"events")==null){a(this).next().bind(f.event,{options:f,hoverBg:e.data.hoverBg,hoverColor:e.data.hoverColor,stepBg:e.data.stepBg,stepColor:e.data.stepColor,panelId:e.data.panelId,contentsSelector:e.data.contentsSelector},b);a(this).next().bind("mouseover",{options:f,hoverBg:e.data.hoverBg,hoverColor:e.data.hoverColor},c);a(this).next().bind("mouseout",{options:f,stepBg:e.data.stepBg,stepColor:e.data.stepColor},d)}}if(f.nextPrevButtons){var l=null;var m=null;if(a(this).next().length&&a(this).next().attr("href")!=undefined)m=a(this).next().attr("href");if(a(this).prev().attr("href")!=undefined&&(f.chooseAgain||f.kind=="freeChoice"))l=a(this).prev().attr("href");if(a(this).next().length&&(a.data(a(this).next().get(0),"events")==null||a.data(a(this).next().get(0),"events")[f.event]==null))m=null;if(a.data(a(this).prev().get(0),"events")==null||a.data(a(this).prev().get(0),"events")[f.event]==null)l=null;a("#"+e.data.panelId+" .nextPrevButtons").remove();if(f.nextPrevButtonsPosition=="top")a("#"+e.data.panelId).prepend("<div class='nextPrevButtons clearfix'><a class='button "+(l!=null?"activeButton-"+f.style:"inactiveButton")+"' title='"+f.prevButtonTitle+"' "+(l!=null?"xref='"+l+"'":"xref='#'")+">"+f.prevButtonTitle+"</a><a class='button "+(m!=null?"activeButton-"+f.style:"inactiveButton")+"' title='"+f.nextButtonTitle+"' "+(m!=null?"xref='"+m+"'":"xref='#'")+">"+f.nextButtonTitle+"</a></div>");else a("#"+e.data.panelId).append("<div class='nextPrevButtons clearfix'><a class='button "+(l!=null?"activeButton-"+f.style:"inactiveButton")+"' title='"+f.prevButtonTitle+"' "+(l!=null?"xref='"+l+"'":"xref='#'")+">"+f.prevButtonTitle+"</a><a class='button "+(m!=null?"activeButton-"+f.style:"inactiveButton")+"' title='"+f.nextButtonTitle+"' "+(m!=null?"xref='"+m+"'":"xref='#'")+">"+f.nextButtonTitle+"</a></div>")}if(!f.markVisited){if(e.data.options.kind=="stepByStep"){a(this).nextAll("a.step").each(function(){a(this).css({"background-position":parseInt(a(this).backgroundPosition().split(" ")[0])+"px "+e.data.stepBg.split(" ")[1],color:e.data.stepColor})});a(this).prevAll("a.step").each(function(){a(this).css({"background-position":parseInt(a(this).backgroundPosition().split(" ")[0])+"px "+e.data.hoverBg.split(" ")[1],color:e.data.hoverColor,cursor:"pointer"})});a(this).prev("a.step").unbind("mouseout",d);a(this).next("a.step").bind("mouseout",{options:f,stepBg:e.data.stepBg,stepColor:e.data.stepColor,panelId:e.data.panelId},d)}else{a(this).siblings("a.step").each(function(){if(a(this).get(0)===a("#"+e.data.panelId).children("[href]").first().get(0))a("#"+e.data.panelId+" .boxStart").css("background-position","-10px "+e.data.stepBg.split(" ")[1]);a(this).css({"background-position":parseInt(a(this).backgroundPosition().split(" ")[0])+"px "+e.data.stepBg.split(" ")[1],color:e.data.stepColor});a(this).bind("mouseout",{options:f,stepBg:e.data.stepBg,stepColor:e.data.stepColor,panelId:e.data.panelId},d)})}}f.afterOpen(e,a(this),g,h)}jQuery.fn.backgroundPosition=function(){var b=a(this).css("background-position");if(typeof b==="undefined"||a.browser.msie&&parseInt(a.browser.version)==9)return a(this).css("background-position-x")+" "+a(this).css("background-position-y");else return b.replace(/%/g,"px")};jQuery.fn.processPanel=function(e){var f={kind:"stepByStep",style:"green-blue",firstSelected:true,icons:true,imgFolder:"img",chooseAgain:true,markVisited:true,nextPrevButtons:true,nextPrevButtonsPosition:"bottom",nextButtonTitle:"Next step",prevButtonTitle:"Previous step",fadeSpeed:1e3,event:"click",beforeLoad:function(){},onLoad:function(){},onOpen:function(){},afterOpen:function(){},onOpenPopup:function(){},onClosePopup:function(){},onHoverIn:function(){},onHoverOut:function(){}};var e=a.extend(f,e);this.getOptions=function(){return e};this.each(function(){e.beforeLoad();var f=a(this).attr("id");var g=a(this).children("[href]").length;var h=new Array;var i="";a(this).children("[href]").each(function(){if(a(this).attr("href").substr(0,1)!="#"){h.push(a(this).attr("href").split("#")[1]);i+="#"+a(this).attr("href").split("#")[1]+","}else{h.push(a(this).attr("href").substr(1));i+=a(this).attr("href")+","}});i=i.substr(0,i.length-1);a(this).children("[href]").first().before("<div class='boxStart boxStart-"+e.style+"'> </div>");var j,k,l,m,n,o;a(i).each(function(){a(this).addClass("content")});a(this).children("[href]").each(function(b){a(this).addClass("step step-"+e.style+" step"+(b+1));if(b==0)a(this).addClass("step"+(b+1)+"-"+e.style);if(!e.icons)a(this).css("background-image","url('"+e.imgFolder+"/sprite_without_icons.png')");if(b>0)a(this).css("padding-left",parseInt(a(this).css("padding-left"))+20+"px");var c;if(b+1==g)c=-551+parseInt(a(this).css("width"))-580+parseInt(a(this).css("padding-left"))+"px "+a(this).backgroundPosition().split(" ")[1];else c=-551+parseInt(a(this).css("width"))-10+parseInt(a(this).css("padding-left"))+"px "+a(this).backgroundPosition().split(" ")[1];a(this).css({"z-index":g-b,"background-position":c});if(b==0){n=a(this);j=a(this).backgroundPosition();k=a(this).css("color");a(this).css("margin-left","0px")}else if(b==1){o=a(this);l=a(this).backgroundPosition();m=a(this).css("color")}if(a(this).attr("label")!=undefined)a(this).append("<span class='stepLabel"+(b+1==g?"Last":"")+"'>"+a(this).attr("label")+"</span>")});if(!e.firstSelected){n.css({"background-position":parseInt(n.backgroundPosition().split(" ")[0])+"px "+l.split(" ")[1],color:m});a("#"+f+" .boxStart").css("background-position","-10px "+l.split(" ")[1])}else n.css("cursor","pointer");if(e.kind=="stepByStep"){if(!e.firstSelected||e.chooseAgain)n.bind(e.event,{options:e,hoverBg:j,hoverColor:k,stepBg:l,stepColor:m,panelId:f,contentsSelector:i},b);else n.bind(e.event,function(a){a.preventDefault()});if(!e.firstSelected){n.bind("mouseover",{options:e,hoverBg:j,hoverColor:k,panelId:f},c);n.bind("mouseout",{options:e,stepBg:l,stepColor:m,panelId:f},d)}else{o.bind("mouseover",{options:e,hoverBg:j,hoverColor:k},c);o.bind("mouseout",{options:e,stepBg:l,stepColor:m},d);o.bind(e.event,{options:e,hoverBg:j,hoverColor:k,stepBg:l,stepColor:m,panelId:f,contentsSelector:i},b)}}else{a(this).children("[href]").each(function(g){if(g>0||!e.firstSelected||!e.markVisited){a(this).bind("mouseover",{options:e,hoverBg:j,hoverColor:k,panelId:f},c);if(g>0||!e.firstSelected)a(this).bind("mouseout",{options:e,stepBg:l,stepColor:m,panelId:f},d);a(this).bind(e.event,{options:e,stepBg:l,stepColor:m,panelId:f,contentsSelector:i},b)}else if(!e.firstSelected||e.chooseAgain)a(this).bind(e.event,{options:e,panelId:f,stepBg:l,stepColor:m,contentsSelector:i},b);else a(this).bind(e.event,function(a){a.preventDefault()})})}a(i).each(function(b){if(!e.firstSelected||a(this).attr("id")!=h[0])a(this).css("display","none");else if(a(this).attr("id")==h[0]&&e.nextPrevButtons){if(e.nextPrevButtonsPosition=="top")a("#"+f).prepend("<div class='nextPrevButtons clearfix'><a xref='#' class='button inactiveButton' title='"+e.prevButtonTitle+"'>"+e.prevButtonTitle+"</a><a xref='"+o.attr("href")+"' class='button activeButton-"+e.style+"' title='"+e.nextButtonTitle+"'>"+e.nextButtonTitle+"</a></div>");else a("#"+f).append("<div class='nextPrevButtons clearfix'><a xref='#' class='button inactiveButton' title='"+e.prevButtonTitle+"'>"+e.prevButtonTitle+"</a><a xref='"+o.attr("href")+"' class='button activeButton-"+e.style+"' title='"+e.nextButtonTitle+"'>"+e.nextButtonTitle+"</a></div>")}});if(e.firstSelected&&n.attr("href")!=undefined&&n.attr("href").substr(0,1)!="#"&&n.attr("href")!=""){var p=n.attr("href").split("#")[0];var q=n.attr("href").split("#")[1];a.ajax({url:p,type:"post",async:false,dataType:"html",success:function(b){a("#"+q).html(b)}})}a("#"+f+" .button[xref!='#']").live("click",function(b){b.preventDefault();a("#"+f+" [href='"+a(this).attr("xref")+"']:not(.button)").trigger("mouseover").trigger("click")});a("[href='#"+f+"-popup']").click(function(b){var c=a(this).attr("href").substr(0,a(this).attr("href").length-6);if(false===e.onOpenPopup(b,a(this),a(c)))return;b.preventDefault();a("body").append("<div class='overlay'></div>");a(c).css({width:a(c).width()+"px","z-index":"101"});a(c).css("top",(a(window).height()-a(c).height())/2+a(window).scrollTop()+"px");a(c).css("left",(a(window).width()-a(c).width())/2+a(window).scrollLeft()+"px");a(c).appendTo("body");a(c).css("display","block");a(".overlay").css({width:a(window).width()+"px",height:a(document).height()+300+"px",opacity:"0.7"});var d;var f=a(c).children("a").length;a(c).children("[href]").each(function(b){if(b+1==f)d=-551+parseInt(a(this).css("width"))-580+parseInt(a(this).css("padding-left"))+"px "+a(this).backgroundPosition().split(" ")[1];else d=-551+parseInt(a(this).css("width"))-10+parseInt(a(this).css("padding-left"))+"px "+a(this).backgroundPosition().split(" ")[1];a(this).css("background-position",d)});a(c).css("opacity","0");a(c).animate({opacity:1},500,function(){if(jQuery.browser.msie)this.style.removeAttribute("filter")});a(".overlay").click(function(b){if(false===e.onClosePopup(b,a(c)))return;a(c).animate({opacity:0},500,function(){a(this).css("display","none")});a(this).remove()});a(window).resize(function(){a(".overlay").css("height",a(document).height()+"px")})});e.onLoad()});return this};a(".inactiveButton").live("click",function(a){a.preventDefault()})})(jQuery)